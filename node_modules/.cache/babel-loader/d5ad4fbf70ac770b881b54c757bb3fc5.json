{"ast":null,"code":"import e, { PureComponent as t } from \"react\";\n\nvar n = function (e, t) {\n  return (n = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (e, t) {\n    e.__proto__ = t;\n  } || function (e, t) {\n    for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]);\n  })(e, t);\n};\n\nvar i = function () {\n  return (i = Object.assign || function (e) {\n    for (var t, n = 1, i = arguments.length; n < i; n++) for (var r in t = arguments[n]) Object.prototype.hasOwnProperty.call(t, r) && (e[r] = t[r]);\n\n    return e;\n  }).apply(this, arguments);\n},\n    r = i(i({\n  scale: 1,\n  perspective: 1e3,\n  flipVertically: !1,\n  flipHorizontally: !1,\n  reset: !0,\n  transitionEasing: \"cubic-bezier(.03,.98,.52,.99)\",\n  transitionSpeed: 400,\n  trackOnWindow: !1,\n  gyroscope: !1\n}, {\n  tiltEnable: !0,\n  tiltReverse: !1,\n  tiltAngleXInitial: 0,\n  tiltAngleYInitial: 0,\n  tiltMaxAngleX: 20,\n  tiltMaxAngleY: 20,\n  tiltAxis: null,\n  tiltAngleXManual: null,\n  tiltAngleYManual: null\n}), {\n  glareEnable: !1,\n  glareMaxOpacity: .7,\n  glareColor: \"#ffffff\",\n  glarePosition: \"bottom\",\n  glareReverse: !1\n});\n\nfunction a(e, t, n, i, r) {\n  return void 0 === r && (r = null), r && clearTimeout(r), e.style.transition = t + \" \" + n + \"ms \" + i, setTimeout(function () {\n    e.style.transition = \"\";\n  }, n);\n}\n\nfunction l(e, t, n) {\n  return Math.min(Math.max(e, t), n);\n}\n\nvar o = function () {\n  var e = this;\n  this.glareAngle = 0, this.glareOpacity = 0, this.tiltAngleX = 0, this.tiltAngleY = 0, this.tiltAngleXPercentage = 0, this.tiltAngleYPercentage = 0, this.update = function (t, n) {\n    e.updateTilt(t, n), e.updateTiltManualInput(t, n), e.updateTiltReverse(n), e.updateTiltLimits(n);\n  }, this.updateTilt = function (t, n) {\n    var i = t.yPercentage,\n        r = n.tiltMaxAngleY;\n    e.tiltAngleX = t.xPercentage * n.tiltMaxAngleX / 100, e.tiltAngleY = i * r / 100 * -1;\n  }, this.updateTiltManualInput = function (t, n) {\n    var i = n.tiltAngleXManual,\n        r = n.tiltAngleYManual,\n        a = n.tiltMaxAngleX,\n        l = n.tiltMaxAngleY;\n    null === i && null === r || (e.tiltAngleX = null !== i ? i : 0, e.tiltAngleY = null !== r ? r : 0, t.xPercentage = 100 * e.tiltAngleX / a, t.yPercentage = 100 * e.tiltAngleY / l);\n  }, this.updateTiltReverse = function (t) {\n    var n = t.tiltReverse ? -1 : 1;\n    e.tiltAngleX = n * e.tiltAngleX, e.tiltAngleY = n * e.tiltAngleY;\n  }, this.updateTiltLimits = function (t) {\n    var n = t.tiltAxis;\n    e.tiltAngleX = l(e.tiltAngleX, -90, 90), e.tiltAngleY = l(e.tiltAngleY, -90, 90), n && (e.tiltAngleX = \"x\" === n ? e.tiltAngleX : 0, e.tiltAngleY = \"y\" === n ? e.tiltAngleY : 0);\n  }, this.updateTiltAnglesPercentage = function (t) {\n    var n = t.tiltMaxAngleY;\n    e.tiltAngleXPercentage = e.tiltAngleX / t.tiltMaxAngleX * 100, e.tiltAngleYPercentage = e.tiltAngleY / n * 100;\n  }, this.render = function (t) {\n    t.style.transform += \"rotateX(\" + e.tiltAngleX + \"deg) rotateY(\" + e.tiltAngleY + \"deg) \";\n  };\n},\n    s = function (e) {\n  var t = this;\n  this.glareAngle = 0, this.glareOpacity = 0, this.calculateGlareSize = function (e) {\n    return {\n      width: 2 * e.width,\n      height: 2 * e.height\n    };\n  }, this.setSize = function (e) {\n    var n = t.calculateGlareSize(e);\n    t.glareEl.style.width = n.width + \"px\", t.glareEl.style.height = n.height + \"px\";\n  }, this.update = function (e, n, i, r) {\n    t.updateAngle(e, n.glareReverse), t.updateOpacity(e, n, i, r);\n  }, this.updateAngle = function (e, n) {\n    var i = e.xPercentage,\n        r = 180 / Math.PI,\n        a = i ? Math.atan2(e.yPercentage, -i) * r : 0;\n    t.glareAngle = a - (n ? 180 : 0);\n  }, this.updateOpacity = function (e, n, i, r) {\n    var a,\n        o = e.xPercentage,\n        s = e.yPercentage,\n        p = n.glareReverse,\n        c = n.glareMaxOpacity,\n        g = i ? -1 : 1,\n        u = r ? -1 : 1;\n\n    switch (n.glarePosition) {\n      case \"top\":\n        a = -o * g;\n        break;\n\n      case \"right\":\n        a = s * u;\n        break;\n\n      case \"bottom\":\n        a = o * g;\n        break;\n\n      case \"left\":\n        a = -s * u;\n        break;\n\n      case \"all\":\n        a = Math.hypot(o, s);\n        break;\n\n      default:\n        a = o * g;\n    }\n\n    var h = l(a = p ? -a : a, 0, 100);\n    t.glareOpacity = h * c / 100;\n  }, this.render = function (e) {\n    var n = e.glareColor;\n    t.glareEl.style.transform = \"rotate(\" + t.glareAngle + \"deg) translate(-50%, -50%)\", t.glareEl.style.opacity = t.glareOpacity.toString(), t.glareEl.style.background = \"linear-gradient(0deg, rgba(255,255,255,0) 0%, \" + n + \" 100%)\";\n  }, this.glareWrapperEl = document.createElement(\"div\"), this.glareEl = document.createElement(\"div\"), this.glareWrapperEl.appendChild(this.glareEl), this.glareWrapperEl.className = \"glare-wrapper\", this.glareEl.className = \"glare\";\n  var n = this.calculateGlareSize(e),\n      i = {\n    position: \"absolute\",\n    top: \"50%\",\n    left: \"50%\",\n    \"transform-origin\": \"0% 0%\",\n    \"pointer-events\": \"none\",\n    width: n.width + \"px\",\n    height: n.height + \"px\"\n  };\n  Object.assign(this.glareWrapperEl.style, {\n    position: \"absolute\",\n    top: \"0\",\n    left: \"0\",\n    width: \"100%\",\n    height: \"100%\",\n    overflow: \"hidden\"\n  }), Object.assign(this.glareEl.style, i);\n},\n    p = function (t) {\n  function i() {\n    var e = null !== t && t.apply(this, arguments) || this;\n    return e.wrapperEl = {\n      node: null,\n      size: {\n        width: 0,\n        height: 0,\n        left: 0,\n        top: 0\n      },\n      clientPosition: {\n        x: null,\n        y: null,\n        xPercentage: 0,\n        yPercentage: 0\n      },\n      transitionTimeoutId: void 0,\n      updateAnimationId: null,\n      childrenImgsCounter: 0,\n      childrenImgsLength: 0,\n      scale: 1\n    }, e.tilt = null, e.glare = null, e.loadWrapperAndChildElements = function () {\n      var t = Array.from(e.wrapperEl.node.getElementsByTagName(\"img\"));\n      e.wrapperEl.childrenImgsLength = t.length, 0 !== e.wrapperEl.childrenImgsLength ? t.forEach(function (t) {\n        t.complete ? e.allImagesLoaded() : t.addEventListener(\"load\", e.allImagesLoaded);\n      }) : e.setSize();\n    }, e.allImagesLoaded = function () {\n      e.wrapperEl.childrenImgsCounter++, e.wrapperEl.childrenImgsCounter === e.wrapperEl.childrenImgsLength && e.setSize();\n    }, e.setSize = function () {\n      e.setWrapperElSize(), e.glare && e.glare.setSize(e.wrapperEl.size);\n    }, e.mainLoop = function (t) {\n      null !== e.wrapperEl.updateAnimationId && cancelAnimationFrame(e.wrapperEl.updateAnimationId), e.processInput(t), e.update(t.type), e.wrapperEl.updateAnimationId = requestAnimationFrame(e.renderFrame);\n    }, e.onEnter = function (t) {\n      var n = e.props.onEnter;\n      e.wrapperEl.node.style.willChange = \"transform\", e.setTransition(), n && n(t.type);\n    }, e.onMove = function (t) {\n      e.mainLoop(t), e.emitOnMove(t);\n    }, e.onLeave = function (t) {\n      var n = e.props.onLeave;\n\n      if (e.setTransition(), n && n(t.type), e.props.reset) {\n        var i = new CustomEvent(\"autoreset\");\n        e.onMove(i);\n      }\n    }, e.processInput = function (t) {\n      var n = e.props.scale;\n\n      switch (t.type) {\n        case \"mousemove\":\n          e.wrapperEl.clientPosition.x = t.pageX, e.wrapperEl.clientPosition.y = t.pageY, e.wrapperEl.scale = n;\n          break;\n\n        case \"touchmove\":\n          e.wrapperEl.clientPosition.x = t.touches[0].pageX, e.wrapperEl.clientPosition.y = t.touches[0].pageY, e.wrapperEl.scale = n;\n          break;\n\n        case \"deviceorientation\":\n          e.processInputDeviceOrientation(t), e.wrapperEl.scale = n;\n          break;\n\n        case \"autoreset\":\n          var i = e.props,\n              r = i.tiltAngleYInitial / i.tiltMaxAngleY * 100;\n          e.wrapperEl.clientPosition.xPercentage = l(i.tiltAngleXInitial / i.tiltMaxAngleX * 100, -100, 100), e.wrapperEl.clientPosition.yPercentage = l(r, -100, 100), e.wrapperEl.scale = 1;\n      }\n    }, e.processInputDeviceOrientation = function (t) {\n      if (t.gamma && t.beta && e.props.gyroscope) {\n        var n = e.props,\n            i = n.tiltMaxAngleY,\n            r = t.gamma;\n        e.wrapperEl.clientPosition.xPercentage = t.beta / n.tiltMaxAngleX * 100, e.wrapperEl.clientPosition.yPercentage = r / i * 100, e.wrapperEl.clientPosition.xPercentage = l(e.wrapperEl.clientPosition.xPercentage, -100, 100), e.wrapperEl.clientPosition.yPercentage = l(e.wrapperEl.clientPosition.yPercentage, -100, 100);\n      }\n    }, e.update = function (t) {\n      var n = e.props,\n          i = n.tiltEnable,\n          r = n.flipVertically,\n          a = n.flipHorizontally;\n      e.updateClientInput(t), i && e.tilt.update(e.wrapperEl.clientPosition, e.props), e.updateFlip(), e.tilt.updateTiltAnglesPercentage(e.props), e.glare && e.glare.update(e.wrapperEl.clientPosition, e.props, r, a);\n    }, e.updateClientInput = function (t) {\n      if (\"autoreset\" !== t && \"deviceorientation\" !== t) {\n        var n, i;\n\n        if (e.props.trackOnWindow) {\n          var r = e.wrapperEl.clientPosition,\n              a = r.x;\n          n = r.y / window.innerHeight * 200 - 100, i = a / window.innerWidth * 200 - 100;\n        } else {\n          var o = e.wrapperEl,\n              s = o.size,\n              p = o.clientPosition;\n          n = (p.y - s.top) / s.height * 200 - 100, i = ((a = p.x) - s.left) / s.width * 200 - 100;\n        }\n\n        e.wrapperEl.clientPosition.xPercentage = l(n, -100, 100), e.wrapperEl.clientPosition.yPercentage = l(i, -100, 100);\n      }\n    }, e.updateFlip = function () {\n      var t = e.props,\n          n = t.flipHorizontally;\n      t.flipVertically && (e.tilt.tiltAngleX += 180, e.tilt.tiltAngleY *= -1), n && (e.tilt.tiltAngleY += 180);\n    }, e.renderFrame = function () {\n      e.resetWrapperElTransform(), e.renderPerspective(), e.tilt.render(e.wrapperEl.node), e.renderScale(), e.glare && e.glare.render(e.props);\n    }, e;\n  }\n\n  return function (e, t) {\n    function i() {\n      this.constructor = e;\n    }\n\n    n(e, t), e.prototype = null === t ? Object.create(t) : (i.prototype = t.prototype, new i());\n  }(i, t), i.prototype.componentDidMount = function () {\n    this.loadWrapperAndChildElements(), this.tilt = new o(), this.initGlare(), this.addEventListeners();\n    var e = new CustomEvent(\"autoreset\");\n    this.mainLoop(e);\n    var t = new CustomEvent(\"initial\");\n    this.emitOnMove(t);\n  }, i.prototype.componentWillUnmount = function () {\n    clearTimeout(this.wrapperEl.transitionTimeoutId), null !== this.wrapperEl.updateAnimationId && cancelAnimationFrame(this.wrapperEl.updateAnimationId), this.removeEventListeners();\n  }, i.prototype.componentDidUpdate = function () {\n    var e = this.props;\n\n    if (!(e.onMove || e.onEnter || e.onLeave)) {\n      var t = new CustomEvent(\"propchange\");\n      this.mainLoop(t);\n    }\n  }, i.prototype.addEventListeners = function () {\n    var e = this.props,\n        t = e.trackOnWindow,\n        n = e.gyroscope;\n\n    if (window.addEventListener(\"resize\", this.setSize), t && (window.addEventListener(\"mouseenter\", this.onEnter), window.addEventListener(\"mousemove\", this.onMove), window.addEventListener(\"mouseout\", this.onLeave), window.addEventListener(\"touchstart\", this.onEnter), window.addEventListener(\"touchmove\", this.onMove), window.addEventListener(\"touchend\", this.onLeave)), n) {\n      if (!window.DeviceOrientationEvent) return void console.error(\"Browser doesn't support Device Orientation.\");\n      window.addEventListener(\"deviceorientation\", this.onMove);\n    }\n  }, i.prototype.removeEventListeners = function () {\n    var e = this.props,\n        t = e.trackOnWindow,\n        n = e.gyroscope;\n    window.removeEventListener(\"resize\", this.setSize), t && (window.removeEventListener(\"mouseenter\", this.onEnter), window.removeEventListener(\"mousemove\", this.onMove), window.removeEventListener(\"mouseout\", this.onLeave), window.removeEventListener(\"touchstart\", this.onEnter), window.removeEventListener(\"touchmove\", this.onMove), window.removeEventListener(\"touchend\", this.onLeave)), n && window.DeviceOrientationEvent && window.removeEventListener(\"deviceorientation\", this.onMove);\n  }, i.prototype.setWrapperElSize = function () {\n    var e = this.wrapperEl.node.getBoundingClientRect();\n    this.wrapperEl.size.width = this.wrapperEl.node.offsetWidth, this.wrapperEl.size.height = this.wrapperEl.node.offsetHeight, this.wrapperEl.size.left = e.left + window.scrollX, this.wrapperEl.size.top = e.top + window.scrollY;\n  }, i.prototype.initGlare = function () {\n    this.props.glareEnable && (this.glare = new s(this.wrapperEl.size), this.wrapperEl.node.appendChild(this.glare.glareWrapperEl));\n  }, i.prototype.emitOnMove = function (e) {\n    var t = this.props.onMove;\n\n    if (t) {\n      var n = 0,\n          i = 0;\n      this.glare && (n = this.glare.glareAngle, i = this.glare.glareOpacity), t(this.tilt.tiltAngleX, this.tilt.tiltAngleY, this.tilt.tiltAngleXPercentage, this.tilt.tiltAngleYPercentage, n, i, e.type);\n    }\n  }, i.prototype.resetWrapperElTransform = function () {\n    this.wrapperEl.node.style.transform = \"\";\n  }, i.prototype.renderPerspective = function () {\n    this.wrapperEl.node.style.transform += \"perspective(\" + this.props.perspective + \"px) \";\n  }, i.prototype.renderScale = function () {\n    var e = this.wrapperEl.scale;\n    this.wrapperEl.node.style.transform += \"scale3d(\" + e + \",\" + e + \",\" + e + \")\";\n  }, i.prototype.setTransition = function () {\n    var e = this.props,\n        t = e.transitionSpeed,\n        n = e.transitionEasing;\n    this.wrapperEl.transitionTimeoutId = a(this.wrapperEl.node, \"all\", t, n, this.wrapperEl.transitionTimeoutId), this.glare && (this.glare.transitionTimeoutId = a(this.glare.glareEl, \"opacity\", t, n, this.glare.transitionTimeoutId));\n  }, i.prototype.render = function () {\n    var t = this,\n        n = this.props;\n    return e.createElement(\"div\", {\n      ref: function (e) {\n        return t.wrapperEl.node = e;\n      },\n      onMouseEnter: this.onEnter,\n      onMouseMove: this.onMove,\n      onMouseLeave: this.onLeave,\n      onTouchStart: this.onEnter,\n      onTouchMove: this.onMove,\n      onTouchEnd: this.onLeave,\n      className: n.className,\n      style: n.style\n    }, n.children);\n  }, i.defaultProps = r, i;\n}(t);\n\nexport default p;","map":{"version":3,"sources":["../src/react-parallax-tilt/defaultProps.ts","../src/features/tilt/defaultProps.ts","../src/features/glare/defaultProps.ts","../src/common/utils.ts","../src/features/tilt/Tilt.ts","../src/features/glare/Glare.ts","../src/react-parallax-tilt/ReactParallaxTilt.tsx"],"names":["defaultProps","scale","perspective","flipVertically","flipHorizontally","reset","transitionEasing","transitionSpeed","trackOnWindow","gyroscope","tiltEnable","tiltReverse","tiltAngleXInitial","tiltAngleYInitial","tiltMaxAngleX","tiltMaxAngleY","tiltAxis","tiltAngleXManual","tiltAngleYManual","glareEnable","glareMaxOpacity","glareColor","glarePosition","glareReverse","setTransition","element","property","duration","timing","timeoutId","clearTimeout","style","transition","setTimeout","constrainToRange","value","rangeMin","rangeMax","Math","min","max","this","wrapperElClientPosition","props","_this","updateTilt","updateTiltManualInput","updateTiltReverse","updateTiltLimits","yPercentage","tiltAngleX","tiltAngleY","xPercentage","tiltAngleXPercentage","tiltAngleYPercentage","transform","wrapperElSize","glareWrapperEl","document","createElement","glareEl","appendChild","className","position","top","left","width","height","overflow","glareSize","calculateGlareSize","styleGlare","transform-origin","pointer-events","Object","assign","updateAngle","updateOpacity","rad2Deg","PI","glareAngle","atan2","flipVerticallyFactor","flipHorizontallyFactor","glareOpacityFactor","hypot","glareOpacityFactorRemoveNegative","glareOpacity","opacity","toString","background","__extends","ReactParallaxTilt","node","size","clientPosition","x","y","transitionTimeoutId","undefined","updateAnimationId","childrenImgsCounter","childrenImgsLength","loadWrapperAndChildElements","tilt","Tilt","initGlare","addEventListeners","autoreset","CustomEvent","mainLoop","initialEvent","emitOnMove","wrapperEl","cancelAnimationFrame","removeEventListeners","propChange","window","addEventListener","setSize","onEnter","onMove","onLeave","DeviceOrientationEvent","console","error","removeEventListener","imgs","Array","from","getElementsByTagName","length","forEach","img","complete","allImagesLoaded","setWrapperElSize","glare","rect","getBoundingClientRect","offsetWidth","offsetHeight","scrollX","scrollY","Glare","event","processInput","update","type","requestAnimationFrame","renderFrame","willChange","autoResetEvent","pageX","pageY","touches","processInputDeviceOrientation","gamma","beta","angleY","eventType","updateClientInput","updateFlip","updateTiltAnglesPercentage","xTemp","yTemp","innerHeight","innerWidth","_c","_d","resetWrapperElTransform","renderPerspective","render","renderScale","_a","React","ref","el","onMouseEnter","onMouseMove","onMouseLeave","onTouchStart","onTouchMove","onTouchEnd"],"mappings":"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","sourcesContent":["import { Props } from './types';\nimport { defaultTiltProps } from '../features/tilt/defaultProps';\nimport { defaultGlareProps } from '../features/glare/defaultProps';\n\nexport const defaultProps: Props = {\n  scale: 1,\n  perspective: 1000,\n  flipVertically: false,\n  flipHorizontally: false,\n  reset: true,\n  transitionEasing: 'cubic-bezier(.03,.98,.52,.99)',\n  transitionSpeed: 400,\n  trackOnWindow: false,\n  gyroscope: false,\n  ...defaultTiltProps,\n  ...defaultGlareProps,\n};\n","import { TiltProps } from './types';\n\nexport const defaultTiltProps: TiltProps = {\n  tiltEnable: true,\n  tiltReverse: false,\n  tiltAngleXInitial: 0,\n  tiltAngleYInitial: 0,\n  tiltMaxAngleX: 20,\n  tiltMaxAngleY: 20,\n  tiltAxis: null,\n  tiltAngleXManual: null,\n  tiltAngleYManual: null,\n};\n","import { GlareProps } from './types';\n\nexport const defaultGlareProps: GlareProps = {\n  glareEnable: false,\n  glareMaxOpacity: 0.7,\n  glareColor: '#ffffff',\n  glarePosition: 'bottom',\n  glareReverse: false,\n};\n","export function setTransition<T extends HTMLElement>(\n  element: T,\n  property: string,\n  duration: number,\n  timing: string,\n  timeoutId: number | null = null,\n): number {\n  if (timeoutId) {\n    clearTimeout(timeoutId);\n  }\n  element.style.transition = `${property} ${duration}ms ${timing}`;\n  return setTimeout(() => {\n    element.style.transition = '';\n  }, duration) as any;\n}\n\nexport function constrainToRange(value: number, rangeMin: number, rangeMax: number): number {\n  return Math.min(Math.max(value, rangeMin), rangeMax);\n}\n","import { TiltProps } from './types';\nimport { constrainToRange } from '../../common/utils';\nimport { ClientPosition } from '../../common/types';\nimport { IStyle } from '../../common/IStyle';\n\nconst TILT_ANGLE_CONSTRAINT = 90;\n\nexport class Tilt<T extends HTMLElement> implements IStyle {\n  public glareAngle: number = 0;\n  public glareOpacity: number = 0;\n\n  public transitionTimeoutId: number | undefined;\n\n  public tiltAngleX: number = 0;\n  public tiltAngleY: number = 0;\n  public tiltAngleXPercentage: number = 0;\n  public tiltAngleYPercentage: number = 0;\n\n  public update = (wrapperElClientPosition: ClientPosition, props: TiltProps): void => {\n    this.updateTilt(wrapperElClientPosition, props);\n    this.updateTiltManualInput(wrapperElClientPosition, props);\n    this.updateTiltReverse(props);\n    this.updateTiltLimits(props);\n  };\n\n  private updateTilt = (wrapperElClientPosition: ClientPosition, props: TiltProps): void => {\n    const { xPercentage, yPercentage } = wrapperElClientPosition;\n    const { tiltMaxAngleX, tiltMaxAngleY } = props;\n\n    // Calculate tilt angle x/y\n    const tiltTowardMouse = -1;\n    this.tiltAngleX = (xPercentage! * tiltMaxAngleX!) / 100;\n    this.tiltAngleY = ((yPercentage! * tiltMaxAngleY!) / 100) * tiltTowardMouse;\n  };\n\n  private updateTiltManualInput = (\n    wrapperElClientPosition: ClientPosition,\n    props: TiltProps,\n  ): void => {\n    const { tiltAngleXManual, tiltAngleYManual, tiltMaxAngleX, tiltMaxAngleY } = props;\n    // if manual input prop is passed, ignore other inputs\n    if (tiltAngleXManual !== null || tiltAngleYManual !== null) {\n      this.tiltAngleX = tiltAngleXManual !== null ? tiltAngleXManual! : 0;\n      this.tiltAngleY = tiltAngleYManual !== null ? tiltAngleYManual! : 0;\n      wrapperElClientPosition.xPercentage = (100 * this.tiltAngleX) / tiltMaxAngleX!;\n      wrapperElClientPosition.yPercentage = (100 * this.tiltAngleY) / tiltMaxAngleY!;\n    }\n  };\n\n  private updateTiltReverse = (props: TiltProps): void => {\n    const tiltReverse = props.tiltReverse ? -1 : 1;\n    this.tiltAngleX = tiltReverse * this.tiltAngleX;\n    this.tiltAngleY = tiltReverse * this.tiltAngleY;\n  };\n\n  private updateTiltLimits = (props: TiltProps): void => {\n    const { tiltAxis } = props;\n\n    // constrain tilt angles\n    this.tiltAngleX = constrainToRange(\n      this.tiltAngleX,\n      -TILT_ANGLE_CONSTRAINT,\n      TILT_ANGLE_CONSTRAINT,\n    );\n    this.tiltAngleY = constrainToRange(\n      this.tiltAngleY,\n      -TILT_ANGLE_CONSTRAINT,\n      TILT_ANGLE_CONSTRAINT,\n    );\n\n    // disable x/y axis for tilting\n    if (tiltAxis) {\n      this.tiltAngleX = tiltAxis === 'x' ? this.tiltAngleX : 0;\n      this.tiltAngleY = tiltAxis === 'y' ? this.tiltAngleY : 0;\n    }\n  };\n\n  public updateTiltAnglesPercentage = (props: TiltProps): void => {\n    const { tiltMaxAngleX, tiltMaxAngleY } = props;\n\n    this.tiltAngleXPercentage = (this.tiltAngleX / tiltMaxAngleX!) * 100;\n    this.tiltAngleYPercentage = (this.tiltAngleY / tiltMaxAngleY!) * 100;\n  };\n\n  public render = (element: T): void => {\n    element.style.transform += `rotateX(${this.tiltAngleX}deg) rotateY(${this.tiltAngleY}deg) `;\n  };\n}\n","import { GlareProps, GlareSize } from './types';\nimport { constrainToRange } from '../../common/utils';\nimport { ElementSizePosition, ClientPosition } from '../../common/types';\nimport { IStyle } from '../../common/IStyle';\n\nconst GLARE_EL_SIZE_FACTOR = 2;\n\nexport class Glare implements IStyle {\n  public glareWrapperEl: HTMLDivElement;\n  public glareEl: HTMLDivElement;\n\n  public glareAngle: number = 0;\n  public glareOpacity: number = 0;\n\n  public transitionTimeoutId: number | undefined;\n\n  constructor(wrapperElSize: ElementSizePosition) {\n    this.glareWrapperEl = document.createElement('div');\n    this.glareEl = document.createElement('div');\n    this.glareWrapperEl.appendChild(this.glareEl);\n    this.glareWrapperEl.className = 'glare-wrapper';\n    this.glareEl.className = 'glare';\n\n    const styleGlareWrapper = {\n      position: 'absolute',\n      top: '0',\n      left: '0',\n      width: '100%',\n      height: '100%',\n      overflow: 'hidden',\n    };\n\n    const glareSize = this.calculateGlareSize(wrapperElSize);\n    const styleGlare = {\n      position: 'absolute',\n      top: '50%',\n      left: '50%',\n      'transform-origin': '0% 0%',\n      'pointer-events': 'none',\n      width: `${glareSize.width}px`,\n      height: `${glareSize.height}px`,\n    };\n\n    Object.assign(this.glareWrapperEl.style, styleGlareWrapper);\n    Object.assign(this.glareEl.style, styleGlare);\n  }\n\n  private calculateGlareSize = (wrapperElSize: ElementSizePosition): GlareSize => {\n    return {\n      width: wrapperElSize.width! * GLARE_EL_SIZE_FACTOR,\n      height: wrapperElSize.height! * GLARE_EL_SIZE_FACTOR,\n    };\n  };\n\n  public setSize = (wrapperElSize: ElementSizePosition): void => {\n    const glareSize = this.calculateGlareSize(wrapperElSize);\n    this.glareEl.style.width = `${glareSize.width}px`;\n    this.glareEl.style.height = `${glareSize.height}px`;\n  };\n\n  public update = (\n    wrapperElClientPosition: ClientPosition,\n    props: GlareProps,\n    flipVertically: boolean,\n    flipHorizontally: boolean,\n  ): void => {\n    this.updateAngle(wrapperElClientPosition, props.glareReverse!);\n    this.updateOpacity(wrapperElClientPosition, props, flipVertically, flipHorizontally);\n  };\n\n  private updateAngle = (wrapperElClientPosition: ClientPosition, glareReverse: boolean): void => {\n    const { xPercentage, yPercentage } = wrapperElClientPosition;\n\n    const rad2Deg = 180 / Math.PI;\n    // top 0째, right +90째, bottom -+180째, left -90째\n    const glareAngle: number = xPercentage ? Math.atan2(yPercentage, -xPercentage) * rad2Deg : 0;\n\n    const addGlareAngle: number = glareReverse ? 180 : 0;\n    this.glareAngle = glareAngle - addGlareAngle;\n  };\n\n  private updateOpacity = (\n    wrapperElClientPosition: ClientPosition,\n    props: GlareProps,\n    flipVertically: boolean,\n    flipHorizontally: boolean,\n  ): void => {\n    const { xPercentage, yPercentage } = wrapperElClientPosition;\n    const { glarePosition, glareReverse, glareMaxOpacity } = props;\n\n    const flipVerticallyFactor = flipVertically ? -1 : 1;\n    const flipHorizontallyFactor = flipHorizontally ? -1 : 1;\n\n    let glareOpacityFactor: number;\n    switch (glarePosition) {\n      case 'top':\n        glareOpacityFactor = -xPercentage! * flipVerticallyFactor;\n        break;\n      case 'right':\n        glareOpacityFactor = yPercentage! * flipHorizontallyFactor;\n        break;\n      case 'bottom':\n        glareOpacityFactor = xPercentage! * flipVerticallyFactor;\n        break;\n      case 'left':\n        glareOpacityFactor = -yPercentage! * flipHorizontallyFactor;\n        break;\n      case 'all':\n        glareOpacityFactor = Math.hypot(xPercentage, yPercentage);\n        break;\n      default:\n        glareOpacityFactor = xPercentage! * flipVerticallyFactor;\n    }\n\n    glareOpacityFactor = glareReverse ? -glareOpacityFactor : glareOpacityFactor;\n    const glareOpacityFactorRemoveNegative: number = constrainToRange(glareOpacityFactor, 0, 100);\n    this.glareOpacity = (glareOpacityFactorRemoveNegative * glareMaxOpacity!) / 100;\n  };\n\n  public render = (props: GlareProps): void => {\n    const { glareColor } = props;\n    this.glareEl.style.transform = `rotate(${this.glareAngle}deg) translate(-50%, -50%)`;\n    this.glareEl.style.opacity = this.glareOpacity.toString();\n\n    const linearGradient: string = `linear-gradient(0deg, rgba(255,255,255,0) 0%, ${glareColor} 100%)`;\n    this.glareEl.style.background = linearGradient;\n  };\n}\n","import React, { PureComponent, MouseEvent, TouchEvent } from 'react';\n\nimport { Props, SupportedEvent, EventType, CustomEventType, WrapperElement } from './types';\nimport { defaultProps } from './defaultProps';\nimport { Tilt } from '../features/tilt/Tilt';\nimport { Glare } from '../features/glare/Glare';\nimport { setTransition, constrainToRange } from '../common/utils';\n\nclass ReactParallaxTilt extends PureComponent<Props> {\n  public static defaultProps = defaultProps;\n  private wrapperEl: WrapperElement<HTMLDivElement> = {\n    node: null,\n    size: {\n      width: 0,\n      height: 0,\n      left: 0,\n      top: 0,\n    },\n    clientPosition: {\n      x: null,\n      y: null,\n      xPercentage: 0,\n      yPercentage: 0,\n    },\n    transitionTimeoutId: undefined,\n    updateAnimationId: null,\n    childrenImgsCounter: 0,\n    childrenImgsLength: 0,\n    scale: 1,\n  };\n  private tilt: Tilt<HTMLDivElement> | null = null;\n  private glare: Glare | null = null;\n\n  public componentDidMount() {\n    this.loadWrapperAndChildElements();\n    this.tilt = new Tilt<HTMLDivElement>();\n    this.initGlare();\n    this.addEventListeners();\n    const autoreset = new CustomEvent<CustomEventType>('autoreset' as CustomEventType);\n    this.mainLoop(autoreset);\n    const initialEvent = new CustomEvent<CustomEventType>('initial' as CustomEventType);\n    this.emitOnMove(initialEvent);\n  }\n\n  public componentWillUnmount() {\n    clearTimeout(this.wrapperEl.transitionTimeoutId);\n    if (this.wrapperEl.updateAnimationId !== null) {\n      cancelAnimationFrame(this.wrapperEl.updateAnimationId);\n    }\n    this.removeEventListeners();\n  }\n\n  public componentDidUpdate() {\n    const { onMove, onEnter, onLeave } = this.props;\n    // Don't request frame if callback prop changed\n    if (onMove || onEnter || onLeave) {\n      return;\n    }\n    const propChange = new CustomEvent<CustomEventType>('propchange' as CustomEventType);\n    this.mainLoop(propChange);\n  }\n\n  private addEventListeners() {\n    const { trackOnWindow, gyroscope } = this.props;\n\n    window.addEventListener('resize', this.setSize);\n\n    if (trackOnWindow) {\n      window.addEventListener('mouseenter', this.onEnter);\n      window.addEventListener('mousemove', this.onMove);\n      window.addEventListener('mouseout', this.onLeave);\n      window.addEventListener('touchstart', this.onEnter);\n      window.addEventListener('touchmove', this.onMove);\n      window.addEventListener('touchend', this.onLeave);\n    }\n\n    if (gyroscope) {\n      /* istanbul ignore next */\n      if (!window.DeviceOrientationEvent) {\n        console.error(\"Browser doesn't support Device Orientation.\");\n        return;\n      }\n      /* istanbul ignore next */\n      window.addEventListener('deviceorientation', this.onMove);\n    }\n  }\n\n  private removeEventListeners() {\n    const { trackOnWindow, gyroscope } = this.props;\n\n    window.removeEventListener('resize', this.setSize);\n\n    if (trackOnWindow) {\n      window.removeEventListener('mouseenter', this.onEnter);\n      window.removeEventListener('mousemove', this.onMove);\n      window.removeEventListener('mouseout', this.onLeave);\n      window.removeEventListener('touchstart', this.onEnter);\n      window.removeEventListener('touchmove', this.onMove);\n      window.removeEventListener('touchend', this.onLeave);\n    }\n\n    // jest - instance of DeviceOrientationEvent not possible\n    /* istanbul ignore next */\n    if (gyroscope && window.DeviceOrientationEvent) {\n      window.removeEventListener('deviceorientation', this.onMove);\n    }\n  }\n\n  private loadWrapperAndChildElements = () => {\n    const imgs = Array.from(this.wrapperEl.node!.getElementsByTagName('img'));\n    this.wrapperEl.childrenImgsLength = imgs.length;\n    if (this.wrapperEl.childrenImgsLength === 0) {\n      this.setSize();\n      return;\n    }\n\n    imgs.forEach(img => {\n      // jest - images are not preloaded\n      /* istanbul ignore next */\n      if (img.complete) {\n        this.allImagesLoaded();\n      } else {\n        img.addEventListener('load', this.allImagesLoaded);\n      }\n    });\n  };\n\n  public allImagesLoaded = () => {\n    this.wrapperEl.childrenImgsCounter++;\n    if (this.wrapperEl.childrenImgsCounter === this.wrapperEl.childrenImgsLength) {\n      this.setSize();\n    }\n  };\n\n  public setSize = () => {\n    this.setWrapperElSize();\n    if (this.glare) {\n      this.glare.setSize(this.wrapperEl.size);\n    }\n  };\n\n  private setWrapperElSize() {\n    const rect = this.wrapperEl.node!.getBoundingClientRect();\n    this.wrapperEl.size.width = this.wrapperEl.node!.offsetWidth;\n    this.wrapperEl.size.height = this.wrapperEl.node!.offsetHeight;\n    this.wrapperEl.size.left = rect.left + window.scrollX;\n    this.wrapperEl.size.top = rect.top + window.scrollY;\n  }\n\n  private initGlare() {\n    const { glareEnable } = this.props;\n\n    if (!glareEnable) {\n      return;\n    }\n\n    this.glare = new Glare(this.wrapperEl.size);\n    this.wrapperEl.node!.appendChild(this.glare.glareWrapperEl);\n  }\n\n  public mainLoop = (event: SupportedEvent) => {\n    if (this.wrapperEl.updateAnimationId !== null) {\n      cancelAnimationFrame(this.wrapperEl.updateAnimationId);\n    }\n    this.processInput(event);\n    this.update(event.type);\n    this.wrapperEl.updateAnimationId = requestAnimationFrame(this.renderFrame);\n  };\n\n  private onEnter = (event: SupportedEvent) => {\n    const { onEnter } = this.props;\n\n    // increase performance by notifying browser 'transform' property is just about to get changed\n    this.wrapperEl.node!.style.willChange = 'transform';\n    this.setTransition();\n\n    if (onEnter) {\n      onEnter(event.type);\n    }\n  };\n\n  private onMove = (event: SupportedEvent): void => {\n    this.mainLoop(event);\n    this.emitOnMove(event);\n  };\n\n  private emitOnMove(event: SupportedEvent) {\n    const { onMove } = this.props;\n    if (!onMove) {\n      return;\n    }\n    let glareAngle = 0;\n    let glareOpacity = 0;\n    if (this.glare) {\n      glareAngle = this.glare.glareAngle;\n      glareOpacity = this.glare.glareOpacity;\n    }\n\n    onMove(\n      this.tilt!.tiltAngleX!,\n      this.tilt!.tiltAngleY!,\n      this.tilt!.tiltAngleXPercentage!,\n      this.tilt!.tiltAngleYPercentage!,\n      glareAngle,\n      glareOpacity,\n      event.type,\n    );\n  }\n\n  private onLeave = (event: SupportedEvent) => {\n    const { onLeave } = this.props;\n    this.setTransition();\n\n    if (onLeave) {\n      onLeave(event.type);\n    }\n\n    if (this.props.reset) {\n      const autoResetEvent = new CustomEvent<CustomEventType>('autoreset' as CustomEventType);\n      this.onMove(autoResetEvent);\n    }\n  };\n\n  private processInput = (event: SupportedEvent): void => {\n    const { scale } = this.props;\n\n    switch (event.type as EventType) {\n      case 'mousemove':\n        this.wrapperEl.clientPosition.x = (event as MouseEvent).pageX;\n        this.wrapperEl.clientPosition.y = (event as MouseEvent).pageY;\n        this.wrapperEl.scale = scale!;\n        break;\n      case 'touchmove':\n        this.wrapperEl.clientPosition.x = (event as TouchEvent).touches[0].pageX;\n        this.wrapperEl.clientPosition.y = (event as TouchEvent).touches[0].pageY;\n        this.wrapperEl.scale = scale!;\n        break;\n      // jest - instance of DeviceOrientationEvent not possible\n      /* istanbul ignore next */\n      case 'deviceorientation':\n        this.processInputDeviceOrientation(event as DeviceOrientationEvent);\n        this.wrapperEl.scale = scale!;\n        break;\n      case 'autoreset':\n        const { tiltAngleXInitial, tiltAngleYInitial, tiltMaxAngleX, tiltMaxAngleY } = this.props;\n        const xPercentage = (tiltAngleXInitial! / tiltMaxAngleX!) * 100;\n        const yPercentage = (tiltAngleYInitial! / tiltMaxAngleY!) * 100;\n        this.wrapperEl.clientPosition.xPercentage = constrainToRange(xPercentage, -100, 100);\n        this.wrapperEl.clientPosition.yPercentage = constrainToRange(yPercentage, -100, 100);\n        this.wrapperEl.scale = 1;\n        break;\n    }\n  };\n\n  // jest - instance of DeviceOrientationEvent not possible\n  /* istanbul ignore next */\n  private processInputDeviceOrientation = (event: DeviceOrientationEvent): void => {\n    if (!event.gamma || !event.beta || !this.props.gyroscope) {\n      return;\n    }\n\n    const { tiltMaxAngleX, tiltMaxAngleY } = this.props;\n\n    const angleX = event.beta; // motion of the device around the x axis in degree in the range:[-180,180]\n    const angleY = event.gamma; // motion of the device around the y axis in degree in the range:[-90,90]\n\n    this.wrapperEl.clientPosition.xPercentage = (angleX! / tiltMaxAngleX!) * 100;\n    this.wrapperEl.clientPosition.yPercentage = (angleY! / tiltMaxAngleY!) * 100;\n\n    this.wrapperEl.clientPosition.xPercentage = constrainToRange(\n      this.wrapperEl.clientPosition.xPercentage,\n      -100,\n      100,\n    );\n    this.wrapperEl.clientPosition.yPercentage = constrainToRange(\n      this.wrapperEl.clientPosition.yPercentage,\n      -100,\n      100,\n    );\n  };\n\n  private update = (eventType: EventType | string): void => {\n    const { tiltEnable, flipVertically, flipHorizontally } = this.props;\n\n    this.updateClientInput(eventType);\n    if (tiltEnable) {\n      this.tilt!.update(this.wrapperEl.clientPosition, this.props);\n    }\n    this.updateFlip();\n    this.tilt!.updateTiltAnglesPercentage(this.props);\n    if (this.glare) {\n      this.glare.update(\n        this.wrapperEl.clientPosition,\n        this.props,\n        flipVertically!,\n        flipHorizontally!,\n      );\n    }\n  };\n\n  private updateClientInput = (eventType: EventType | string): void => {\n    // on 'autoreset' event - nothing to update, everything set to default already\n    // on 'deviceorientation' event - don't calculate tilt angle, retrieved from gyroscope\n    if (eventType === 'autoreset' || eventType === 'deviceorientation') {\n      return;\n    }\n\n    const { trackOnWindow } = this.props;\n\n    let xTemp;\n    let yTemp;\n    if (trackOnWindow) {\n      const { x, y } = this.wrapperEl.clientPosition;\n\n      xTemp = (y! / window.innerHeight) * 200 - 100;\n      yTemp = (x! / window.innerWidth) * 200 - 100;\n    } else {\n      const {\n        size: { width, height, left, top },\n        clientPosition: { x, y },\n      } = this.wrapperEl;\n\n      xTemp = ((y! - top!) / height!) * 200 - 100;\n      yTemp = ((x! - left!) / width!) * 200 - 100;\n    }\n\n    this.wrapperEl.clientPosition.xPercentage = constrainToRange(xTemp, -100, 100);\n    this.wrapperEl.clientPosition.yPercentage = constrainToRange(yTemp, -100, 100);\n  };\n\n  private updateFlip = (): void => {\n    const { flipVertically, flipHorizontally } = this.props;\n\n    if (flipVertically) {\n      this.tilt!.tiltAngleX += 180;\n      this.tilt!.tiltAngleY *= -1;\n    }\n    if (flipHorizontally) {\n      this.tilt!.tiltAngleY += 180;\n    }\n  };\n\n  public renderFrame = (): void => {\n    this.resetWrapperElTransform();\n\n    this.renderPerspective();\n    this.tilt!.render(this.wrapperEl.node!);\n    this.renderScale();\n    if (this.glare) {\n      this.glare.render(this.props);\n    }\n  };\n\n  private resetWrapperElTransform(): void {\n    this.wrapperEl.node!.style.transform = '';\n  }\n\n  private renderPerspective(): void {\n    const { perspective } = this.props;\n\n    this.wrapperEl.node!.style.transform += `perspective(${perspective}px) `;\n  }\n\n  private renderScale(): void {\n    const { scale } = this.wrapperEl;\n\n    this.wrapperEl.node!.style.transform += `scale3d(${scale},${scale},${scale})`;\n  }\n\n  private setTransition() {\n    const { transitionSpeed, transitionEasing } = this.props;\n\n    this.wrapperEl.transitionTimeoutId = setTransition<HTMLDivElement>(\n      this.wrapperEl.node!,\n      'all',\n      transitionSpeed!,\n      transitionEasing!,\n      this.wrapperEl.transitionTimeoutId,\n    );\n\n    if (this.glare) {\n      this.glare.transitionTimeoutId = setTransition<HTMLDivElement>(\n        this.glare.glareEl,\n        'opacity',\n        transitionSpeed!,\n        transitionEasing!,\n        this.glare.transitionTimeoutId,\n      );\n    }\n  }\n\n  public render() {\n    const { children, className, style } = this.props;\n    return (\n      <div\n        ref={el => (this.wrapperEl.node = el)}\n        onMouseEnter={this.onEnter}\n        onMouseMove={this.onMove}\n        onMouseLeave={this.onLeave}\n        onTouchStart={this.onEnter}\n        onTouchMove={this.onMove}\n        onTouchEnd={this.onLeave}\n        className={className}\n        style={style}\n      >\n        {children}\n      </div>\n    );\n  }\n}\n\nexport default ReactParallaxTilt;\n"]},"metadata":{},"sourceType":"module"}